<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MX-WEBSCAN - Reporte de Seguridad</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f5f5;
            color: #333;
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #004b8d, #0066b3);
            color: white;
            padding: 30px;
            text-align: center;
            border-bottom: 5px solid #ce1126;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header h1 span {
            color: #ffd700;
        }
        
        .header .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .header .mexico {
            margin-top: 15px;
            font-size: 1.1em;
            color: #ffd700;
        }
        
        .info-section {
            padding: 30px;
            background: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .info-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .info-item strong {
            color: #004b8d;
            display: block;
            margin-bottom: 5px;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .info-item .value {
            font-size: 1.3em;
            font-weight: bold;
            color: #333;
        }
        
        .stats-section {
            padding: 30px;
            background: white;
        }
        
        .stats-section h2 {
            color: #004b8d;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #dee2e6;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            color: white;
        }
        
        .stat-card.critical {
            background: #dc3545;
        }
        
        .stat-card.high {
            background: #fd7e14;
        }
        
        .stat-card.medium {
            background: #ffc107;
            color: #333;
        }
        
        .stat-card.low {
            background: #28a745;
        }
        
        .stat-card .number {
            font-size: 2.5em;
            font-weight: bold;
        }
        
        .stat-card .label {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .vulnerabilities-section {
            padding: 30px;
            background: #f8f9fa;
        }
        
        .vulnerabilities-section h2 {
            color: #004b8d;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #dee2e6;
        }
        
        .vuln-group {
            margin-bottom: 30px;
        }
        
        .vuln-group h3 {
            padding: 10px 15px;
            background: #e9ecef;
            border-radius: 5px;
            margin-bottom: 15px;
            color: #333;
        }
        
        .vuln-group.sql h3 {
            border-left: 5px solid #dc3545;
        }
        
        .vuln-group.xss h3 {
            border-left: 5px solid #fd7e14;
        }
        
        .vuln-group.lfi h3 {
            border-left: 5px solid #ffc107;
        }
        
        .vuln-card {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            border-left: 3px solid #dee2e6;
        }
        
        .vuln-card.critical {
            border-left-color: #dc3545;
        }
        
        .vuln-card.high {
            border-left-color: #fd7e14;
        }
        
        .vuln-card.medium {
            border-left-color: #ffc107;
        }
        
        .vuln-card.low {
            border-left-color: #28a745;
        }
        
        .vuln-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .vuln-param {
            font-weight: bold;
            color: #004b8d;
            font-size: 1.1em;
        }
        
        .vuln-payload {
            font-family: 'Courier New', monospace;
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-size: 0.9em;
            word-break: break-all;
        }
        
        .vuln-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 10px;
            font-size: 0.9em;
        }
        
        .vuln-details div {
            padding: 5px;
            background: #f8f9fa;
            border-radius: 3px;
        }
        
        .badge {
            padding: 3px 8px;
            border-radius: 3px;
            font-size: 0.8em;
            font-weight: bold;
            color: white;
        }
        
        .badge.critical { background: #dc3545; }
        .badge.high { background: #fd7e14; }
        .badge.medium { background: #ffc107; color: #333; }
        .badge.low { background: #28a745; }
        
        .recommendations-section {
            padding: 30px;
            background: white;
        }
        
        .recommendations-section h2 {
            color: #004b8d;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #dee2e6;
        }
        
        .recommendations-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .rec-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-top: 3px solid #004b8d;
        }
        
        .rec-card h4 {
            color: #004b8d;
            margin-bottom: 10px;
        }
        
        .rec-card ul {
            list-style-position: inside;
            color: #666;
        }
        
        .rec-card li {
            margin-bottom: 5px;
        }
        
        .footer {
            padding: 20px;
            text-align: center;
            background: #333;
            color: white;
            font-size: 0.9em;
        }
        
        .footer a {
            color: #ffd700;
            text-decoration: none;
        }
        
        .footer a:hover {
            text-decoration: underline;
        }
        
        @media print {
            body {
                background: white;
                padding: 0;
            }
            
            .container {
                box-shadow: none;
            }
            
            .header {
                background: #004b8d;
                color: white;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            
            .stat-card {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            
            .badge {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üá≤üáΩ <span>MX-WEBSCAN</span> üá≤üáΩ</h1>
            <div class="subtitle">Reporte de An√°lisis de Vulnerabilidades Web</div>
            <div class="mexico">Hecho en M√©xico - Ciberseguridad con Huevos ü•öüî•</div>
        </div>
        
        <div class="info-section">
            <h2>üìã Informaci√≥n del Escaneo</h2>
            <div class="info-grid">
                <div class="info-item">
                    <strong>Objetivo</strong>
                    <div class="value">{{target}}</div>
                </div>
                <div class="info-item">
                    <strong>Fecha del An√°lisis</strong>
                    <div class="value">{{date}}</div>
                </div>
                <div class="info-item">
                    <strong>Duraci√≥n</strong>
                    <div class="value">{{duration}}</div>
                </div>
                <div class="info-item">
                    <strong>Hilos Utilizados</strong>
                    <div class="value">{{threads}}</div>
                </div>
            </div>
        </div>
        
        <div class="stats-section">
            <h2>üìä Resumen de Vulnerabilidades</h2>
            <div class="stats-grid">
                <div class="stat-card critical">
                    <div class="number">{{critical_count}}</div>
                    <div class="label">Cr√≠ticas</div>
                </div>
                <div class="stat-card high">
                    <div class="number">{{high_count}}</div>
                    <div class="label">Altas</div>
                </div>
                <div class="stat-card medium">
                    <div class="number">{{medium_count}}</div>
                    <div class="label">Medias</div>
                </div>
                <div class="stat-card low">
                    <div class="number">{{low_count}}</div>
                    <div class="label">Bajas</div>
                </div>
            </div>
            
            <div style="text-align: center; margin-top: 20px;">
                <div style="font-size: 1.2em; color: #666;">
                    Total de Vulnerabilidades Encontradas: <strong>{{total_count}}</strong>
                </div>
            </div>
        </div>
        
        <div class="vulnerabilities-section">
            <h2>üîç Vulnerabilidades Detectadas</h2>
            
            {{vulnerabilities}}
            
            {{#if sql_injection}}
            <div class="vuln-group sql">
                <h3>‚ö†Ô∏è SQL Injection ({{sql_injection.length}})</h3>
                {{#each sql_injection}}
                <div class="vuln-card critical">
                    <div class="vuln-header">
                        <span class="vuln-param">Par√°metro: {{parametro}}</span>
                        <span class="badge critical">CR√çTICO</span>
                    </div>
                    <div class="vuln-payload">Payload: {{payload}}</div>
                    <div class="vuln-details">
                        <div>C√≥digo HTTP: {{codigo}}</div>
                        <div>Tiempo Respuesta: {{tiempo}}s</div>
                    </div>
                    <div style="margin-top: 10px; color: #dc3545;">
                        <strong>Riesgo:</strong> Acceso no autorizado a base de datos, extracci√≥n de informaci√≥n sensible
                    </div>
                </div>
                {{/each}}
            </div>
            {{/if}}
            
            {{#if lfi}}
            <div class="vuln-group lfi">
                <h3>üìÅ Local File Inclusion ({{lfi.length}})</h3>
                {{#each lfi}}
                <div class="vuln-card high">
                    <div class="vuln-header">
                        <span class="vuln-param">Par√°metro: {{parametro}}</span>
                        <span class="badge high">ALTO</span>
                    </div>
                    <div class="vuln-payload">Payload: {{payload}}</div>
                    <div class="vuln-details">
                        <div>C√≥digo HTTP: {{codigo}}</div>
                    </div>
                    <div style="margin-top: 10px; color: #fd7e14;">
                        <strong>Riesgo:</strong> Lectura de archivos del sistema, posible ejecuci√≥n de c√≥digo
                    </div>
                </div>
                {{/each}}
            </div>
            {{/if}}
            
            {{#if xss}}
            <div class="vuln-group xss">
                <h3>üíâ Cross-Site Scripting ({{xss.length}})</h3>
                {{#each xss}}
                <div class="vuln-card medium">
                    <div class="vuln-header">
                        <span class="vuln-param">Par√°metro: {{parametro}}</span>
                        <span class="badge medium">MEDIO</span>
                    </div>
                    <div class="vuln-payload">Payload: {{payload}}</div>
                    <div class="vuln-details">
                        <div>C√≥digo HTTP: {{codigo}}</div>
                    </div>
                    <div style="margin-top: 10px; color: #ffc107;">
                        <strong>Riesgo:</strong> Robo de cookies, sesiones, redirecci√≥n a sitios maliciosos
                    </div>
                </div>
                {{/each}}
            </div>
            {{/if}}
            
            {{#if info}}
            <div class="vuln-group">
                <h3>‚ÑπÔ∏è Informaci√≥n Revelada ({{info.length}})</h3>
                {{#each info}}
                <div class="vuln-card low">
                    <div class="vuln-header">
                        <span class="vuln-param">{{parametro}}</span>
                        <span class="badge low">BAJO</span>
                    </div>
                    <div>{{mensaje}}</div>
                </div>
                {{/each}}
            </div>
            {{/if}}
        </div>
        
        <div class="recommendations-section">
            <h2>üõ°Ô∏è Recomendaciones de Seguridad</h2>
            <div class="recommendations-grid">
                <div class="rec-card">
                    <h4>SQL Injection</h4>
                    <ul>
                        <li>Usar consultas parametrizadas (Prepared Statements)</li>
                        <li>Validar y sanitizar todos los inputs</li>
                        <li>Implementar WAF (Web Application Firewall)</li>
                        <li>M√≠nimos privilegios en base de datos</li>
                    </ul>
                </div>
                
                <div class="rec-card">
                    <h4>XSS (Cross-Site Scripting)</h4>
                    <ul>
                        <li>Implementar Content Security Policy (CSP)</li>
                        <li>Escapar output con funciones como htmlspecialchars()</li>
                        <li>Usar cabeceras HttpOnly en cookies</li>
                        <li>Validar tipo de contenido en respuestas</li>
                    </ul>
                </div>
                
                <div class="rec-card">
                    <h4>File Inclusion</h4>
                    <ul>
                        <li>Validar rutas de archivos contra whitelist</li>
                        <li>Deshabilitar wrappers remotos (allow_url_include)</li>
                        <li>No usar input del usuario para incluir archivos</li>
                        <li>Mantener actualizado PHP/software</li>
                    </ul>
                </div>
                
                <div class="rec-card">
                    <h4>Mejoras Generales</h4>
                    <ul>
                        <li>Implementar HTTPS estricto</li>
                        <li>Cabeceras de seguridad: HSTS, X-Frame-Options</li>
                        <li>Actualizar componentes y librer√≠as</li>
                        <li>Auditor√≠as peri√≥dicas de seguridad</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>MX-WEBSCAN v1.0 - Herramienta de Ciberseguridad Hecha en M√©xico üá≤üáΩ</p>
            <p>Reporte generado autom√°ticamente por FalconMX Security</p>
            <p>üìß mariofalcon030901@gmail.com | üìû +52 55 6126 4662</p>
            <p><a href="https://falconmx1.github.io/mx_falconmx_security/">https://falconmx1.github.io/mx_falconmx_security/</a></p>
        </div>
    </div>
</body>
</html>
